<!DOCTYPE html>

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Haraka Manual &raquo; helo.checks plugin</title>
        <link rel="stylesheet" type="text/css" href="/reset.css">
        <link rel="stylesheet" type="text/css" href="/chapter.css">
        <link rel="stylesheet" type="text/css" href="/sh_emacs.css">
        <script type="text/javascript" src="/sh_main.min.js"></script>
        <script type="text/javascript" src="/sh_javascript.min.js"></script>
        <script type="text/javascript">
        window.onload = function () {
            var pres = document.getElementsByTagName("pre"),
                text;

            for (var i = 0; i < pres.length; ++i) {
                text = pres[i].innerText || "";

                if (!(/^\s*\$/).test(text)) {
                    pres[i].className = "sh_javascript";
                }
            }

            sh_highlightDocument();
        }
        </script>
    </head>
    <body>
        <div id="content">
            <h1>helo.checks</h1>

<p>This plugin performs a number of checks on the HELO string.</p>

<p>HELO strings are very often forged or dubious in spam and so this can be a
highly effective and false-positive free anti-spam measure.</p>

<h2>Configuration</h2>

<ul>
<li><p>helo.checks.regexps</p>

<p>List of regular expressions to match against the HELO string. The regular
expressions are automatically wrapped in <code>^</code> and <code>$</code> so they always match
the entire string.</p></li>
<li><p>helo.checks.ini</p>

<p>INI file which controls enabling of certain checks:</p>

<ul>
<li><p>check<em>no</em>dot=1</p>

<p>Checks that the HELO has at least one '.' in it.</p></li>
<li><p>check<em>raw</em>ip=1</p>

<p>Checks for HELO <IP> where the IP is not surrounded by square brackets.
This is an RFC violation so should always be enabled.</p></li>
<li><p>check_dynamic=1</p>

<p>Checks to see if all or part the connecting IP address appears within 
the HELO argument to indicate that the client has a dynamic IP address.</p></li>
<li><p>check<em>literal</em>mismatch=1|2</p>

<p>Checks to see if the IP literal used matches the connecting IP address.
If set to 1, the full IP must match.  If set to 2, the /24 must match.</p></li>
<li><p>require<em>valid</em>tld=1</p>

<p>Requires the HELO argument ends in a valid TLD if it is not an IP literal.</p></li>
<li><p>skip<em>private</em>ip=1</p>

<p>Bypasses check<em>no</em>dot, check<em>raw</em>ip, check<em>dynamic and require</em>valid_tld 
for clients within RFC1918, Loopback or APIPA IP address ranges.</p></li>
<li><p>[bigco]</p>

<p>A list of <helo>=<rdns>[,<rdns>...] to match against. If the HELO matches
what's on the left hand side, the reverse-DNS must match one of the
entries on the right hand side or the mail is blocked.</p>

<p>Example:</p>

<pre><code>yahoo.com=yahoo.com,yahoo.co.jp
aol.com=aol.com
</code></pre></li>
</ul></li>
</ul>

        </div>
    </body>
</html>
